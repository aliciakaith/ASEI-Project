<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ASEI – Unified Integration Platform • Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="icon" type="image/png" href="images/connectify_logo.png">
</head>

<body class="bg-gray-900 min-h-screen">
  <div class="flex flex-col items-center px-6 gap-6">
    <header class="pt-10">
      <a href="#" class="flex items-center text-2xl font-semibold text-white -ml-8">
        <img class="w-auto h-10 mr-2" src="images/connectify_logo.png" alt="Logo">
        Connectify    
      </a>
    </header>

    <main class="w-full max-w-md mx-auto">
      <div class="bg-gray-800 rounded-lg shadow border border-gray-700">
        <div class="p-6 sm:p-8">
          <h1 class="text-xl font-bold leading-tight tracking-tight text-white md:text-2xl">
            Create an account
          </h1>
          <p class="text-sm font-light text-gray-400">
            Already have an account? 
            <a href="login.html" class="font-medium text-[#5daeff] hover:underline">Login here</a>
          </p>

          <!-- SIGNUP FORM -->
          <form id="signup-form" action="/api/auth/signup" method="POST" class="space-y-3 md:space-y-4 mt-4">
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
              <div>
                <label for="first-name" class="block mb-2 text-sm font-medium text-white">Given Name(s)</label>
                <input type="text" id="first-name" name="givenName"
                       class="bg-gray-700 border-gray-600 text-white text-sm rounded-lg block w-full p-2.5" required>
              </div>
              <div>
                <label for="last-name" class="block mb-2 text-sm font-medium text-white">Surname</label>
                <input type="text" id="last-name" name="surname"
                       class="bg-gray-700 border-gray-600 text-white text-sm rounded-lg block w-full p-2.5" required>
              </div>
            </div>
          
            <div>
              <label for="email" class="block mb-2 text-sm font-medium text-white">Email</label>
              <input type="email" id="email" name="email"
                     class="bg-gray-700 border border-gray-600 text-white text-sm rounded-lg block w-full p-2.5" required>
            </div>

            <!-- Password -->
            <div>
              <label for="password" class="block mb-2 text-sm font-medium text-white">Password</label>
              <input type="password" id="password" name="password"
                     class="bg-gray-700 border border-gray-600 text-white text-sm rounded-lg block w-full p-2.5"
                     required aria-describedby="pw-hints">
              <!-- Live strength + rules -->
              <div id="pw-hints" class="mt-2 space-y-2">
                <div class="w-full h-1.5 bg-gray-700 rounded overflow-hidden">
                  <div id="pw-strength" class="h-full bg-gray-500 w-0 transition-all duration-200"></div>
                </div>
                <ul class="text-xs space-y-1 text-gray-400" id="pw-rules" aria-live="polite">
                  <li id="rule-length"  class="flex items-center gap-2"><span>•</span> At least 8 characters</li>
                  <li id="rule-lower"   class="flex items-center gap-2"><span>•</span> At least one lowercase letter</li>
                  <li id="rule-upper"   class="flex items-center gap-2"><span>•</span> At least one uppercase letter</li>
                  <li id="rule-number"  class="flex items-center gap-2"><span>•</span> At least one number</li>
                  <li id="rule-special" class="flex items-center gap-2"><span>•</span> At least one special (@ $ ! % * ? & . # ^)</li>
                </ul>
              </div>
            </div>

            <!-- Confirm -->
            <div>
              <label for="confirm-password" class="block mb-2 text-sm font-medium text-white">Confirm password</label>
              <input type="password" id="confirm-password" name="confirmPassword"
                     class="bg-gray-700 border border-gray-600 text-white text-sm rounded-lg block w-full p-2.5"
                     required aria-describedby="pw-match-msg">
              <p id="pw-match-msg" class="text-xs mt-1 text-gray-400" aria-live="polite"></p>
            </div>
          
            <div class="flex items-start">
              <div class="flex items-center h-5">
                <input id="terms" type="checkbox" name="acceptTerms" value="on"
                       class="w-4 h-4 border border-gray-600 rounded bg-gray-700" required>
              </div>
              <div class="ml-3 text-sm text-gray-300">
                <label for="terms" class="font-light">I accept the</label>
                <a href="/terms" class="font-medium text-[#5daeff] hover:underline ml-1" target="_blank" rel="noopener">
                  Terms and Conditions
                </a>
              </div>
            </div>
          
            <button type="submit" class="w-full text-white bg-[#3f9fff] hover:bg-[#1188ff] font-medium rounded-lg text-sm px-5 py-2.5 text-center">
              Create an account
            </button>
          </form>

          <div id="signup-error" class="mt-3 text-sm text-red-400 hidden"></div>

          <div class="flex items-center my-6">
            <div class="flex-grow border-t border-gray-500"></div>
            <span class="px-3 text-sm text-gray-400">or</span>
            <div class="flex-grow border-t border-gray-500"></div>
          </div>

          <h1 class="text-xl font-bold leading-tight tracking-tight text-white md:text-2xl">
            Continue with
          </h1>

          <!-- Google option -->
          <div class="space-y-3 w-full">
            <a href="/api/auth/google"
               class="w-full p-2.5 inline-flex items-center justify-center gap-3 rounded-lg border border-gray-600 bg-white text-gray-900 text-sm font-medium hover:bg-gray-50">
              <img src="images/G_logo.png" alt="G" class="w-5 h-5"/>
              <span>Sign up with Google</span>
            </a>
          </div>
        </div>
      </div>
    </main>
  </div>

<script>
  const form = document.getElementById("signup-form");
  const errorBox = document.getElementById("signup-error");
  const passwordEl = document.getElementById("password");
  const confirmEl  = document.getElementById("confirm-password");
  const matchMsg   = document.getElementById("pw-match-msg");
  const submitBtn  = form.querySelector('button[type="submit"]');
  const strengthEl = document.getElementById("pw-strength");

  const ruleEls = {
    length:  document.getElementById("rule-length"),
    lower:   document.getElementById("rule-lower"),
    upper:   document.getElementById("rule-upper"),
    number:  document.getElementById("rule-number"),
    special: document.getElementById("rule-special"),
  };

  function checkRules(pw) {
    return {
      length:  /.{8,}/.test(pw),
      lower:   /[a-z]/.test(pw),
      upper:   /[A-Z]/.test(pw),
      number:  /\d/.test(pw),
      special: /[@$!%*?&.#^]/.test(pw),
    };
  }

  function updateChecklist(pw) {
    const res = checkRules(pw);
    Object.entries(res).forEach(([key, ok]) => {
      const el = ruleEls[key];
      el.classList.toggle("text-green-400", ok);
      el.classList.toggle("text-gray-400", !ok);
      el.firstElementChild.textContent = ok ? "✓" : "•";
    });

    // simple strength meter = % rules satisfied
    const passed = Object.values(res).filter(Boolean).length;
    const pct = (passed / 5) * 100;
    strengthEl.style.width = pct + "%";
    strengthEl.className = "h-full transition-all duration-200 " +
      (passed <= 2 ? "bg-red-500" : passed === 3 ? "bg-yellow-500" : passed === 4 ? "bg-lime-500" : "bg-green-500");

    return passed === 5;
  }

  function updateMatch() {
    const pw = passwordEl.value;
    const okAllRules = updateChecklist(pw);
    const match = pw.length > 0 && pw === confirmEl.value;

    matchMsg.textContent = match ? "Passwords match." : (confirmEl.value ? "Passwords do not match." : "");
    matchMsg.className = "text-xs mt-1 " + (match ? "text-green-400" : "text-red-400");

    // Enable submit only if rules pass + match
    submitBtn.disabled = !(okAllRules && match);
    submitBtn.classList.toggle("opacity-50", submitBtn.disabled);
    submitBtn.classList.toggle("cursor-not-allowed", submitBtn.disabled);
  }

  // live checks
  passwordEl.addEventListener("input", updateMatch);
  confirmEl.addEventListener("input", updateMatch);

  // initial state
  updateMatch();

  form.addEventListener("submit", (e) => {
    errorBox.classList.add("hidden");

    const rulesOk = updateChecklist(passwordEl.value);
    const matchOk = passwordEl.value === confirmEl.value;
    const termsOk = document.getElementById("terms").checked;

    // Stop submission only if invalid
    if (!(rulesOk && matchOk && termsOk)) {
      e.preventDefault();
      errorBox.textContent = "Please fix the highlighted fields and accept the Terms.";
      errorBox.classList.remove("hidden");
    }
    // If valid, DO NOT preventDefault — browser will POST the form
    // to /api/auth/signup and follow the backend redirect (e.g., /dashboard).
  });
</script>

</body>
</html>
